<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:Gemini.Avalonia.Modules.Settings.ViewModels"
        x:Class="Gemini.Avalonia.Modules.Settings.Views.SettingsWindow"
        x:DataType="vm:SettingsViewModel"
        Title="{Binding DisplayName}"
        Width="800"
        Height="600"
        MinWidth="600"
        MinHeight="400"
        WindowStartupLocation="CenterOwner"
        ShowInTaskbar="False">

  <Window.Styles>
    <Style Selector="TreeViewItem">
      <Setter Property="IsExpanded" Value="True" />
    </Style>
  </Window.Styles>

  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="*" />
      <RowDefinition Height="Auto" />
    </Grid.RowDefinitions>

    <!-- 主内容区域 -->
    <Grid Grid.Row="0" Margin="10">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="250" />
        <ColumnDefinition Width="5" />
        <ColumnDefinition Width="*" />
      </Grid.ColumnDefinitions>

      <!-- 左侧设置页面树 -->
      <Border Grid.Column="0" 
              BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
              BorderThickness="1"
              Background="{DynamicResource SystemControlBackgroundAltHighBrush}">
        <TreeView ItemsSource="{Binding Pages}"
                  SelectedItem="{Binding SelectedPage}"
                  Margin="5">
          <TreeView.ItemTemplate>
            <TreeDataTemplate ItemsSource="{Binding Children}">
              <TextBlock Text="{Binding Name}" />
            </TreeDataTemplate>
          </TreeView.ItemTemplate>
        </TreeView>
      </Border>

      <!-- 分隔符 -->
      <GridSplitter Grid.Column="1" 
                    Background="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
                    HorizontalAlignment="Stretch" />

      <!-- 右侧设置内容 -->
      <Border Grid.Column="2"
              BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
              BorderThickness="1"
              Background="{DynamicResource SystemControlBackgroundAltHighBrush}">
        <ScrollViewer Margin="10">
          <ContentControl Content="{Binding SelectedPage}" />
        </ScrollViewer>
      </Border>
    </Grid>

    <!-- 底部按钮区域 -->
    <Border Grid.Row="1"
            BorderBrush="{DynamicResource SystemControlForegroundBaseMediumLowBrush}"
            BorderThickness="0,1,0,0"
            Background="{DynamicResource SystemControlBackgroundChromeMediumLowBrush}"
            Padding="10">
      <StackPanel Orientation="Horizontal"
                  HorizontalAlignment="Right"
                  Spacing="10">
        <Button Content="{Binding OkButtonText}"
                Command="{Binding SaveChangesCommand}"
                IsDefault="True"
                MinWidth="75"
                Click="OnOkClick" />
        <Button Content="{Binding CancelButtonText}"
                Command="{Binding CancelCommand}"
                IsCancel="True"
                MinWidth="75"
                Click="OnCancelClick" />
      </StackPanel>
    </Border>
  </Grid>
</Window>